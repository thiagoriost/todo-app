<div class="categories-container"
  (click)="cerrarMenu()"
>
  <div class="header">
    <h2>Categor√≠as</h2>
    <button (click)="toggleForm()" class="btn-new">
      {{ showForm() ? 'Cancelar' : '+ Nueva Categor√≠a' }}
    </button>
  </div>

  @if (showForm()) {
    <div class="category-form">
      <form [formGroup]="categoryForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <input
            type="text"
            formControlName="name"
            placeholder="Nombre de la categor√≠a"
          />
        </div>

        <div class="form-row">
          <div class="form-group">
            <input
              type="color"
              formControlName="color"
              title="Color"
            />
          </div>

          <div class="form-group">
            <input
              type="text"
              formControlName="icon"
              placeholder="Icono (emoji o nombre)"
            />
          </div>
        </div>

        <div class="form-group">
          <input
            type="text"
            formControlName="description"
            placeholder="Descripci√≥n (opcional)"
          />
        </div>

        <button type="submit" class="btn-submit" [disabled]="categoryForm.invalid">
          Guardar
        </button>
      </form>
    </div>
  }

  <div class="categories-grid">
    @if (loading()) {
      <div class="loading">Cargando categor√≠as...</div>
    } @else if (categories().length === 0) {
      <div class="empty">No hay categor√≠as disponibles</div>
    } @else {
      @for (category of categories(); track category.id) {
        <div class="category-card" [style.border-left-color]="category.color">
          <div class="category-header">
            @if (category.icon) {
              <span class="category-icon">{{ category.icon }}</span>
            }
            <h3>{{ category.name }}</h3>
          </div>

          @if (category.description) {
            <p class="description">{{ category.description }}</p>
          }

          <div class="category-footer">
            <span class="task-count">
              {{ category.taskCount || 0 }} tareas
            </span>
            <div class="actions">
              <button (click)="editCategory(category)" class="btn-icon">‚úèÔ∏è</button>
              <button (click)="deleteCategory(category.id)" class="btn-icon">üóëÔ∏è</button>
            </div>
          </div>
        </div>
      }
    }
  </div>
</div>
